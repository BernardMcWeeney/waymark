---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const title = "Security Blog";
const description = "Insights, tutorials, and news about IT security, Microsoft 365, and network infrastructure.";
---

<BaseLayout title={title} description={description}>
	<!-- Hero Section -->
	<section class="relative py-24 lg:py-32 overflow-hidden">
		<div class="absolute inset-0">
			<div class="absolute inset-0 bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950"></div>
			<div class="absolute top-1/4 right-1/4 w-96 h-96 bg-brand-500/10 rounded-full blur-3xl"></div>
		</div>

		<div class="container-wide relative z-10">
			<div class="max-w-4xl">
				<span class="badge-brand mb-6">Blog</span>
				<h1 class="text-5xl md:text-6xl font-bold text-white mb-6">
					Security Insights & News
				</h1>
				<p class="text-xl text-slate-400 max-w-2xl">
					Expert perspectives on cybersecurity trends, Microsoft 365 best practices, and enterprise IT solutions.
				</p>
			</div>
		</div>
	</section>

	<!-- Blog Posts Grid -->
	<section class="section-padding">
		<div class="container-wide">
			{posts.length > 0 && (
				<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
					<!-- Featured Post -->
					<a href={`/blog/${posts[0].id}/`} class="lg:col-span-2 group block">
						<div class="card overflow-hidden hover-lift">
							<div class="grid lg:grid-cols-2">
								<div class="aspect-video lg:aspect-auto bg-slate-800 relative overflow-hidden">
									{posts[0].data.heroImage && (
										<img
											src={posts[0].data.heroImage}
											alt={posts[0].data.title}
											class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
										/>
									)}
									<div class="absolute inset-0 bg-gradient-to-r from-transparent to-slate-900/50 lg:bg-gradient-to-t lg:from-slate-900/60 lg:to-transparent"></div>
								</div>
								<div class="p-8 lg:p-12 flex flex-col justify-center">
									<span class="badge-accent mb-4 w-fit">Featured</span>
									<h2 class="text-2xl lg:text-3xl font-bold text-white mb-4 group-hover:text-brand-400 transition-colors">
										{posts[0].data.title}
									</h2>
									<p class="text-slate-400 mb-4 line-clamp-2">
										{posts[0].data.description}
									</p>
									<div class="flex items-center text-sm text-slate-500">
										<FormattedDate date={posts[0].data.pubDate} />
									</div>
								</div>
							</div>
						</div>
					</a>

					<!-- Other Posts -->
					{posts.slice(1).map((post) => (
						<a href={`/blog/${post.id}/`} class="group block">
							<div class="card overflow-hidden hover-lift h-full">
								<div class="aspect-video bg-slate-800 relative overflow-hidden">
									{post.data.heroImage && (
										<img
											src={post.data.heroImage}
											alt={post.data.title}
											class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
										/>
									)}
									<div class="absolute inset-0 bg-gradient-to-t from-slate-900/60 to-transparent"></div>
								</div>
								<div class="p-6">
									<h3 class="text-xl font-semibold text-white mb-2 group-hover:text-brand-400 transition-colors line-clamp-2">
										{post.data.title}
									</h3>
									<p class="text-slate-400 text-sm mb-4 line-clamp-2">
										{post.data.description}
									</p>
									<div class="flex items-center justify-between text-sm text-slate-500">
										<FormattedDate date={post.data.pubDate} />
										<span class="text-brand-400 group-hover:translate-x-1 transition-transform inline-flex items-center">
											Read more
											<svg class="w-4 h-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
												<path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
											</svg>
										</span>
									</div>
								</div>
							</div>
						</a>
					))}
				</div>
			)}

			{posts.length === 0 && (
				<div class="text-center py-20">
					<div class="w-20 h-20 rounded-2xl bg-slate-800 flex items-center justify-center mx-auto mb-6">
						<svg class="w-10 h-10 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
							<path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
						</svg>
					</div>
					<h3 class="text-2xl font-bold text-white mb-2">No posts yet</h3>
					<p class="text-slate-400">Check back soon for security insights and tutorials.</p>
				</div>
			)}
		</div>
	</section>

	<!-- Newsletter CTA -->
	<section class="section-padding bg-slate-900/50">
		<div class="container-wide">
			<div class="max-w-2xl mx-auto text-center">
				<h2 class="text-3xl font-bold text-white mb-4">
					Stay Updated on Security Trends
				</h2>
				<p class="text-slate-400 mb-8">
					Subscribe to our newsletter for the latest security insights, best practices, and industry news.
				</p>
				<form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
					<input
						type="email"
						placeholder="Enter your email"
						class="flex-1 px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-transparent"
					/>
					<button type="submit" class="btn-primary whitespace-nowrap">
						Subscribe
					</button>
				</form>
			</div>
		</div>
	</section>
</BaseLayout>
